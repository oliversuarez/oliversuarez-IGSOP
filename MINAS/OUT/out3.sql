text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

CREATE Procedure [dbo].[usp_PostulantesManteGenCsv]
As
Begin
	Select
	--CONSULTA MANTENIMIENTO GENERICO (esMante=true)
	--[0] Grilla
	--[0] TITULOS DE COLUMNAS
	'ID|TIPO|NUMERO|APELLIDOS Y NOMBRES|F.NACIMIENTO|UNIDAD|EMPRESA|AREA|PUESTO|ESTADO¬'+
	--[1] ANCHO DE CAMPOS PARA LA GRILLA
	'10|200|150|600|80|150|100|100|300|100¬'+
	--[2] TIPOS DE DATOS
	'Int32|String|String|String|Date|String|String|String|String|String¬' + 
	(Select STUFF((Select '¬' + 
	convert(varchar,Pos_id) + '|' + 
	DocId_Nombre + '|' + Pos_DocNumero +'|' + 
	Pos_ApPat + ' ' + Pos_ApMat +  ' ' + Pos_Nombres +  '|' + IsNull(convert(varchar,Pos_NacFecha,103),'1/1/1900')+'|'+ 
	UM_Nombre + '|'+Emp_NombreCorto + '|'+ Area_Descripcion + '|'+Pues_Nombre+ '|'+PosEst_Nombre
	From Postulantes
	INNER JOIN t_DocsIdentidad on Pos_DocTipoId = DocId_Id
	INNER JOIN PostulantesEstados on Pos_EstadoId = PosEst_Id 
    INNER JOIN UMs on Pos_UMId = UM_Id 
    INNER JOIN Areas on Pos_AreaId = Area_Id 
    INNER JOIN Empresas on Pos_EmpresaId = Emp_Id 
	INNER JOIN Puestos on Pos_PuestoPostulaId = Pues_Id
	ORDER BY CONCAT(Pos_ApPat,Pos_ApMat,Pos_Nombres)
	FOR XML PATH('')), 1, 1, '')) + '_' +
	-- [1] Diseño Popup   --> p= aparece En el Popup | G=GUARDAR R= REQUERIDO C=COMBO
	'90|100|5¬' + -- ANCHO|ALTO|CANT COMBOS PARA LA GRILLA, despues de este numero, combos para el popup
	'Código|txtCodigo|50|P G¬' +
	'Tipo Doc.|cboDocTipo|150|P G R C¬' +
	'Doc.Nro|txtDocNum|150|P G R¬' +
	'Ap. Paterno|txtApPat|150|P G R¬' +
	'Ap. Materno|txtApMat|150|P G R¬' +
	'Ap. Nombres|txtNom|250|P G R¬' +
	'Fecha Nacimiento|txtNacFecha|150|P G R¬' +
	'Unidad Minera|cboUM|150|P G R C¬' +
	'Empresa|cboEmpresa|150|P G R C¬' +
	'Area|cboArea|150|P G R C¬' +
	'Puesto|cboPuesto|150|P G C¬' +
	'Estado|cboEstado|150|P G C' + '_' +
	-- 3er GRUPO [2] Indices y tipos de Combos en la GRILLA c=combo normal, m=combo con check
	'c1|x5|x6|x7|x8|x9' + '_' +  -- c= Combo normal x=Combo check
	-- 4to GRUPO [3] n-3 combos, select para combos en la grilla
	-- Combo Documentos Identidad (0)
	(Select STUFF((Select '¬' + convert(varchar,DocId_Id) + '|' + DocId_Nombre 
	From t_DocsIdentidad
	FOR XML PATH('')), 1, 1, ''))  + '_' +
	-- Combo Unidades Mineras (1)
	(Select STUFF((Select '¬' + convert(varchar,UM_Id) + '|' + UM_Nombre 
	From UMs
	FOR XML PATH('')), 1, 1, '')) + '_' +

	-- Combo Empresas (2)
	(Select STUFF((Select '¬' + convert(varchar,Emp_Id) + '|' + Emp_NombreCorto
	From Empresas
	FOR XML PATH('')), 1, 1, '')) + '_' +

	-- Combo Areas (3)
	(Select STUFF((Select '¬' + convert(varchar,Area_Id) + '|' + Area_Descripcion
	From Areas
	FOR XML PATH('')), 1, 1, '')) + '_' +
	
	-- Combo Puestos (4)
	(Select STUFF((Select '¬' + convert(varchar,Pues_Id) + '|' + Pues_Nombre
	From Puestos
	FOR XML PATH('')), 1, 1, ''))  + '_' +
	
	-- Combo Estados (5)
	(Select STUFF((Select '¬' + convert(varchar,PosEst_Id) + '|' + PosEst_Nombre
	From PostulantesEstados
	FOR XML PATH('')), 1, 1, ''))  + '_' +

	-- Combo Tipos de Vias (6)
	(Select STUFF((Select '¬' + convert(varchar,Via_Id) + '|' + Via_Nombre
	From t_DomVias
	FOR XML PATH('')), 1, 1, ''))  
	
	
	
End
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

(1 rows affected)
